<!DOCTYPE html>
<html lang="fr">
 
<!-- Mirrored from lecluseo.scenari-community.org/CircuitPython/co/g_robhot.html by HTTraQt Website Copier/1.x [Karbofos 2012-2017] mer., 24 août 2022 06:41:08 GMT -->
<head>
  <meta http-equiv="x-ua-compatible" content="IE=EDGE">
  <title>rob_hot : le robot guidé à la chaleur - niveau intermédiaire [Rendre les objets intelligents grâce à Python]</title>
  <meta charset="UTF-8">
  <meta name="generator" content="SCENARI 5.0.2 / Opale 3.7.001">
  <meta name="revision" content="2020-02-19 14:55">
  <link rel="start" href="module_Micropython.html" title="Rendre les objets intelligents gr&acirc;ce &agrave; Python">
  <meta name="author" content="Olivier L&eacute;cluse
Creative Common BY-NC-SA
">
  <meta name="keywords" content>
  <meta name="date" content="2 F&eacute;vrier 2019">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="../lib-md/w_scImgMgr/scImgMgr.css">
  <link rel="stylesheet" type="text/css" href="../lib-md/w_scCodeMgr/scCodeMgr.css">
  <script type="text/JavaScript">
/*0*/ var scServices = {id:"k6tfv97s"};
/*1*/ window.scLoadParams = {destUri:"/co/g_robhot.html", pathToRoot:"../"};
</script>
  <script type="text/JavaScript" src="../lib-sc/scCoLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scSiLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scTiLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scPaLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scMapMgr.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scTooltipMgr.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scDynUiMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/s_assmnt.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scDragMgr.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scAssmntMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_mathjax/mathjaxMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/s_scSearch/scSearch.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_tplMgr/tplMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_scCodeMgr/scCodeMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_searchMgr/searchMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_scMediaMgr/scMediaMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_scImgMgr/scImgMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_outMgr/outMgr.js"></script>
  <script type="text/JavaScript">

/*0*/ try{if(window.opener && window.opener.scServices && window.opener.scServices.id == scServices.id) scServices = window.opener.scServices; else if(window.parent && window.parent.scServices && window.parent.scServices.id == scServices.id) scServices = window.parent.scServices;}catch(e){}
scCodeMgr.registerCode("des:div.code");

scImgMgr.registerAdaptedImage("ide:content/des:img");

scImgMgr.registerGallery("des:div.galFra");

scImgMgr.registerSvg("des:svg");
scImgMgr.registerZoom("des:a.svgZoom",{type:"svg",svgMax:1,toolbar:1,titlePath:"par:/nsi:/des:span.capTi"});

scImgMgr.registerZoom("des:a.imgZoom",{toolbar:1,mag:1,titlePath:"par:/nsi:/des:span.capTi"});

</script>
  <link type="text/css" rel="stylesheet" href="../skin/css/main.css" media="all">
  <link type="text/css" rel="stylesheet" href="../skin/css/skin.css" media="all">
  <link type="text/css" rel="stylesheet" href="../skin/css/print.css" media="print">
  <script type="text/JavaScript">
outMgr.declareOutline("module_Micropython.txt");
	</script> </head>
 <body class="default module expUc">
  <div id="root"><header id="header" role="banner"><h1><span>Rendre les objets intelligents grâce à Python</span></h1><nav role="navigation"><ul id="accessibility"><li class="waiContent"><a href="#content"><span>contenu</span></a></li><li class="waiMenu"><a href="#menu"><span>menu</span></a></li><li class="waiNav"><a href="#navigation"><span>navigation</span></a></li><li class="waiTools"><a href="#tools"><span>outils</span></a></li></ul></nav></header><main id="main" role="main"><div id="document"><div id="content" tabindex="-1"><div class="scroller"><hr class="hidden"><section class="hBk article expUc"><h2 class="hBk_ti"><span>rob_hot : le robot guidé à la chaleur - niveau intermédiaire</span></h2><div class="hBk_co "><div class="iBk info"><div class="iBk_co "><div class="rBk "><p>Dans ce projet, nous allons fabriquer un robot qui se guide tout seul vers une source de chaleur. Celui-ci s'appuiera sur une plate-forme <a class="txt_ul ucLnk subLnk" target="_blank" role="button" href="g_maqueen.html" onclick="scDynUiMgr.displaySubWindow(this,&quot;g_maqueen.html&quot;,&quot;subWindow&quot;,{CLOSEBTNTI :'Fermer'});return false;" onkeyup="scDynUiMgr.handleBtnKeyUp(event);" onkeydown="scDynUiMgr.handleBtnKeyDwn(event);" id="i2" title="Utiliser le robot Maqueen sur Python (nouvelle fen&ecirc;tre)"><span>maqueen<a class="txt_ul ucLnk subLnk" target="_blank" role="button" href="g_maqueen.html" onclick="scDynUiMgr.displaySubWindow(this,&quot;g_maqueen.html&quot;,&quot;subWindow&quot;,{CLOSEBTNTI :'Fermer'});return false;" onkeyup="scDynUiMgr.handleBtnKeyUp(event);" onkeydown="scDynUiMgr.handleBtnKeyDwn(event);" id="i3" title="Utiliser le robot Maqueen sur Python (nouvelle fen&ecirc;tre)"><span></span></a></span></a></p></div><div class="rBk "><p>La détection de chaleur se fera via le capteur AMG8833 pour lequel <a class="op_txt_ul" target="_blank" href="../../../external.html?link=https://www.adafruit.com/product/3538" rel="noopener" title="adafruit propose un module i2c (nouvelle fen&ecirc;tre)"><span>adafruit propose un module i2c</span></a> simple à mettre en œuvre. Il est disponible en France, par exemple chez <a class="op_txt_ul" target="_blank" href="../../../external.html?link=https://www.mouser.fr/ProductDetail/485-3538" rel="noopener" title="mouser (nouvelle fen&ecirc;tre)"><span>mouser</span></a>.</p></div></div></div><section class="hBk expUcDiv"><h3 class="hBk_ti"><span>Découverte du capteur AMG8833</span></h3><div class="hBk_co "><div class="iBk info"><div class="iBk_co "><div class="rBk "><div class="txtRes "><div class="img lft "><figure role="group" class="resInFlow jpeg"><div class="resInFlow_co "><a href="../res/3538-01.jpg" class="imgZoom" target="_blank" onclick="scImgMgr.loading(); return false;" title="Cliquez pour agrandir (nouvelle fen&ecirc;tre)"><img src="../res/3538-01_1.jpg" width="300" height="225" alt></a></div></figure></div><div class="txt "><p>Le capteur AMG8833 se connecte à la carte microbit via une interface i2C. Celle-ci ne nécessite que 2 fils : SDA et SCL en plus l'alimentation (entre 3 et 5v). Il est compatible arduino, raspberry pi, microbit ainsi que bien sûr les cartes adafruit fonctionnant avec circuitpython. Adafruit fournit d'ailleurs une librairie pour prendre en charge ce capteur.</p></div></div></div></div></div><div class="method pBk"><h4 class="method_ti pBk_ti"><span><i class="type"><span>Méthode</span></i><span class="hidden"> : </span><span class="title">Prise en charge sous Microbit</span></span></h4><div class="method_co pBk_co"><div class="rBk "><p>La librairie Adafruit n'est pas compatible avec la carte microbit. Je l'ai donc adaptée à cette dernière. Le fonctionnement du capteur est assez simple : il renvoie une matrice 8x8 de nombres flottants correspondant aux températures lues dans la zone de vision du capteur.</p></div><div class="rBk "><div class="txtRes "><div class="img lft "><figure role="group" class="resInFlow jpeg"><div class="resInFlow_co "><img src="../res/IMG_1211.jpg" width="261" height="291" alt></div></figure></div><div class="txt "><p>Pour le branchement, connectez</p><ul class="txt_il "><li class="txt_ili "><p>VIN sur le 3V de la carte microbit</p></li><li class="txt_ili "><p>GND sur GND</p></li><li class="txt_ili "><p>SCL et SDA sur les broches SCL (19) et SDA (20) de la microbit.</p></li></ul><p>Cela nécessite une carte d'extension. On peut aussi utiliser le robot <a class="txt_ul ucLnk subLnk" target="_blank" role="button" href="g_maqueen.html" onclick="scDynUiMgr.displaySubWindow(this,&quot;g_maqueen.html&quot;,&quot;subWindow&quot;,{CLOSEBTNTI :'Fermer'});return false;" onkeyup="scDynUiMgr.handleBtnKeyUp(event);" onkeydown="scDynUiMgr.handleBtnKeyDwn(event);" id="i4" title="Utiliser le robot Maqueen sur Python (nouvelle fen&ecirc;tre)"><span>maqueen</span></a> qui offre une connectique i2c (juste derrière le capteur ultrasons).</p></div></div></div><div class="rBk "><p>Voici le code permettant de tester le bon fonctionnement du dispositif.</p></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-python"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre><span class="cm-keyword">import</span> <span class="cm-variable">microbit</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre><span class="cm-keyword">import</span> <span class="cm-variable">ustruct</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre><span class="cm-keyword">class</span> <span class="cm-def">Amg8833</span>():</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">addr</span>=<span class="cm-number">0x69</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre>        <span class="cm-string">"""Initiaisation capteur</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre><span class="cm-string">        addr : adresse i2c. 0x69 par defaut"""</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">8</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">addr</span> = <span class="cm-variable">addr</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">9</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">register</span> = <span class="cm-number">0x80</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">10</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">size</span> = <span class="cm-number">8</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">11</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">offset</span> = <span class="cm-number">0</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">12</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">rate</span> = <span class="cm-number">1</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">13</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">14</div><pre>        <span class="cm-comment"># PCTL NORMAL</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">15</div><pre>        <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">16</div><pre>        <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">17</div><pre>        <span class="cm-comment"># INITIAL RESET</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">18</div><pre>        <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x01'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">19</div><pre>        <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x3F'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">20</div><pre>        <span class="cm-comment"># FPS 10</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">21</div><pre>        <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x02'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">22</div><pre>        <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">23</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">24</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">getval</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">val</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">25</div><pre>        <span class="cm-variable">absval</span> = (<span class="cm-variable">val</span> <span class="cm-operator">&amp;</span> <span class="cm-number">0x7FF</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">26</div><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">val</span> <span class="cm-operator">&amp;</span> <span class="cm-number">0x800</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">27</div><pre>            <span class="cm-keyword">return</span> <span class="cm-operator">-</span> <span class="cm-builtin">float</span>(<span class="cm-number">0x800</span> <span class="cm-operator">-</span> <span class="cm-variable">absval</span>) <span class="cm-operator">*</span> <span class="cm-number">0.25</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">28</div><pre>        <span class="cm-keyword">else</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">29</div><pre>            <span class="cm-keyword">return</span> <span class="cm-builtin">float</span>(<span class="cm-variable">absval</span>) <span class="cm-operator">*</span> <span class="cm-number">0.25</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">30</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">31</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">pixels</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">32</div><pre>        <span class="cm-variable">pixs</span> = [[<span class="cm-number">0</span>]<span class="cm-operator">*</span><span class="cm-variable-2">self</span>.<span class="cm-property">size</span> <span class="cm-keyword">for</span> <span class="cm-variable">_</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">size</span>)]</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">33</div><pre>        <span class="cm-variable">reg</span> = <span class="cm-variable-2">self</span>.<span class="cm-property">register</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">34</div><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">ir</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">35</div><pre>            <span class="cm-keyword">for</span> <span class="cm-variable">ic</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">36</div><pre>                <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytes</span>([<span class="cm-variable">reg</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">37</div><pre>                <span class="cm-variable">val</span> = <span class="cm-variable">ustruct</span>.<span class="cm-property">unpack</span>(<span class="cm-string">'&lt;h'</span>, </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">38</div><pre>                                     <span class="cm-variable">microbit</span>.<span class="cm-property">i2c</span>.<span class="cm-property">read</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-variable">reg</span>, <span class="cm-number">2</span>))[<span class="cm-number">0</span>]</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">39</div><pre>                <span class="cm-variable">tmp</span> = (<span class="cm-variable-2">self</span>.<span class="cm-property">getval</span>(<span class="cm-variable">val</span>) <span class="cm-operator">-</span> <span class="cm-variable-2">self</span>.<span class="cm-property">offset</span>) <span class="cm-operator">*</span> <span class="cm-variable-2">self</span>.<span class="cm-property">rate</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">40</div><pre>                <span class="cm-variable">pixs</span>[<span class="cm-variable">ir</span>][<span class="cm-variable">ic</span>] = <span class="cm-variable">tmp</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">41</div><pre>                <span class="cm-variable">reg</span> += <span class="cm-number">2</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">42</div><pre>        <span class="cm-keyword">return</span> <span class="cm-variable">pixs</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">43</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">44</div><pre><span class="cm-variable">amg</span> = <span class="cm-variable">Amg8833</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">45</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">46</div><pre><span class="cm-keyword">while</span> <span class="cm-keyword">True</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">47</div><pre>    <span class="cm-builtin">print</span>(<span class="cm-variable">amg</span>.<span class="cm-property">pixels</span>())</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">48</div><pre></pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;">import microbit
import ustruct

class Amg8833():
    def __init__(self, addr=0x69):
        """Initiaisation capteur
        addr : adresse i2c. 0x69 par defaut"""
        self.addr = addr
        self.register = 0x80
        self.size = 8
        self.offset = 0
        self.rate = 1

        # PCTL NORMAL
        microbit.i2c.write(self.addr, b'0x00')
        microbit.i2c.write(self.addr, b'0x00')
        # INITIAL RESET
        microbit.i2c.write(self.addr, b'0x01')
        microbit.i2c.write(self.addr, b'0x3F')
        # FPS 10
        microbit.i2c.write(self.addr, b'0x02')
        microbit.i2c.write(self.addr, b'0x00')

    def getval(self, val):
        absval = (val &amp; 0x7FF)
        if val &amp; 0x800:
            return - float(0x800 - absval) * 0.25
        else:
            return float(absval) * 0.25

    def pixels(self):
        pixs = [[0]*self.size for _ in range(self.size)]
        reg = self.register
        for ir in range(0, self.size):
            for ic in range(0, self.size):
                microbit.i2c.write(self.addr, bytes([reg]))
                val = ustruct.unpack('&lt;h', 
                                     microbit.i2c.read(self.addr, reg, 2))[0]
                tmp = (self.getval(val) - self.offset) * self.rate
                pixs[ir][ic] = tmp
                reg += 2
        return pixs

amg = Amg8833()

while True:
    print(amg.pixels())
</pre></div></div></div><div class="rBk "><p>On obtient en retour quelque chose ressemblant à cela : une matrice 8x8 de températures. difficile d'imaginer plus simple !</p><p><code class="txt_code_is ">[</code></p><p><code class="txt_code_is ">[20.25, 20.5, 22.0, 23.75, 22.75, 22.25, 23.5, 23.25],</code></p><p><code class="txt_code_is ">[19.75, 20.75, 22.25, 24.25, 23.25, 22.0, 21.75, 20.0],</code></p><p><code class="txt_code_is ">[18.75, 20.25, 21.25, 21.5, 20.75, 20.5, 20.0, 18.5],</code></p><p><code class="txt_code_is ">[19.75, 17.25, 18.75, 18.75, 18.5, 18.0, 18.5, 17.5],</code></p><p><code class="txt_code_is ">[18.25, 17.25, 17.75, 18.0, 17.25, 17.0, 17.25, 17.5],</code></p><p><code class="txt_code_is ">[19.0, 18.0, 18.5, 18.0, 16.75, 16.75, 17.75, 17.25],</code></p><p><code class="txt_code_is ">[19.0, 18.25, 18.75, 18.5, 17.5, 17.5, 17.75, 17.75],</code></p><p><code class="txt_code_is ">[19.5, 17.75, 17.5, 18.25, 17.25, 17.25, 17.25, 17.25]</code></p><p><code class="txt_code_is ">]</code></p></div></div></div></div></section><section class="hBk expUcDiv"><h3 class="hBk_ti"><span>Détection de la source de chaleur</span></h3><div class="hBk_co "><div class="iBk info"><div class="iBk_co "><div class="rBk "><p>Dans cette partie, nous allons rechercher la source de chaleur. Pour cela, nous allons parcourir la matrice de températures à la recherche du plus grand nombre et récupérer la colonne dans laquelle il se trouve.</p><ul class="txt_il "><li class="txt_ili "><p>Si l'indice de cette colonne est entre 0 et 2, on considérera que la source de chaleur est à gauche face au robot. On allumera alors sa LED droite.</p></li><li class="txt_ili "><p>Si l'indice de cette colonne est supérieure à 5, on considérera que la source est à droite face au robot. On allumera alors sa LED gauche.</p></li><li class="txt_ili "><p>Sinon, la source de chaleur est à peu près centrée.</p></li></ul><p>Dans le même temps, nous allumerons sur la matrice LED les 25 pixels au centre du capteur, avec une luminosité d'autant plus grande que la source de chaleur est importante.</p></div><div class="rBk res"><figure role="group" class="resInFlow remoteVideo"><div class="resInFlow_co "><div class="mediaPlayer" id="RmU9g0JMwEeQehygDj7iPc" data-src="https://youtu.be/wjH-l-_YktM" data-max-width="630" data-max-height="630" data-alt-otherencoding="no" data-alt-istranscript="no" data-alt-transcriptinfosdoc="no" data-alt-transcript="text" data-alt-audiodesc="no" data-alt-audiodesctype="no" data-alt-altvideo="no" data-subtitles="no">
<video controls class="remoteVideo " style="max-width:630px;max-height:630px;"><source src="../../../external.html?link=https://youtu.be/wjH-l-_YktM"></source><em>Votre navigateur ne prend pas en charge cette ressource, vous pouvez la télécharger ici : <a target="_blank" href="../../../external.html?link=https://youtu.be/wjH-l-_YktM"><span>wjH-l-_YktM</span></a></em></video></div></div><figcaption class="resInFlow_ti "><span class="title">détection source de chaleur</span></figcaption></figure></div></div></div><div class="method pBk"><h4 class="method_ti pBk_ti"><span><i class="type"><span>Méthode</span></i><span class="hidden"> : </span><span class="title">Programme Python</span></span></h4><div class="method_co pBk_co"><div class="rBk "><p>Voici le programme correspondant. J'ai ajouté une méthode <strong class="txt_emp_is ">hotspot_x</strong> à la classe Amg8833. Celle-ci parcourt les pixels en mémorisant l'indice de colonne du pixel le plus chaud. C'est cet indice qui est renvoyé.</p><p>Dans le même temps, cette méthode affiche sur la matrice LED les pixels du centre du capteur, en exploitant les 9 niveaux de luminosité possible en fonction de la température.</p></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-python"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre><span class="cm-keyword">import</span> <span class="cm-variable">microbit</span> <span class="cm-keyword">as</span> <span class="cm-variable">mb</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre><span class="cm-keyword">import</span> <span class="cm-variable">ustruct</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre><span class="cm-keyword">class</span> <span class="cm-def">Amg8833</span>():</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">addr</span>=<span class="cm-number">0x69</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre>        <span class="cm-string">"""Initiaisation capteur</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre><span class="cm-string">        addr : adresse i2c. 0x69 par defaut"""</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">8</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">addr</span> = <span class="cm-variable">addr</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">9</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">register</span> = <span class="cm-number">0x80</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">10</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">size</span> = <span class="cm-number">8</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">11</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">offset</span> = <span class="cm-number">0</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">12</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">rate</span> = <span class="cm-number">1</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">13</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">14</div><pre>        <span class="cm-comment"># PCTL NORMAL</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">15</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">16</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">17</div><pre>        <span class="cm-comment"># INITIAL RESET</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">18</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x01'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">19</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x3F'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">20</div><pre>        <span class="cm-comment"># FPS 10</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">21</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x02'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">22</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">23</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">24</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">getval</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">val</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">25</div><pre>        <span class="cm-variable">absval</span> = (<span class="cm-variable">val</span> <span class="cm-operator">&amp;</span> <span class="cm-number">0x7FF</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">26</div><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">val</span> <span class="cm-operator">&amp;</span> <span class="cm-number">0x800</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">27</div><pre>            <span class="cm-keyword">return</span> <span class="cm-operator">-</span> <span class="cm-builtin">float</span>(<span class="cm-number">0x800</span> <span class="cm-operator">-</span> <span class="cm-variable">absval</span>) <span class="cm-operator">*</span> <span class="cm-number">0.25</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">28</div><pre>        <span class="cm-keyword">else</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">29</div><pre>            <span class="cm-keyword">return</span> <span class="cm-builtin">float</span>(<span class="cm-variable">absval</span>) <span class="cm-operator">*</span> <span class="cm-number">0.25</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">30</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">31</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">convpix</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">val</span>, <span class="cm-variable">m1</span>, <span class="cm-variable">m2</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">32</div><pre>        <span class="cm-variable">r</span> = <span class="cm-builtin">int</span>((<span class="cm-variable">val</span><span class="cm-operator">-</span><span class="cm-variable">m1</span>)<span class="cm-operator">/</span>(<span class="cm-variable">m2</span><span class="cm-operator">-</span><span class="cm-variable">m1</span>)<span class="cm-operator">*</span><span class="cm-number">9</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">33</div><pre>        <span class="cm-variable">r</span> = <span class="cm-builtin">min</span>(<span class="cm-number">9</span>, <span class="cm-variable">r</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">34</div><pre>        <span class="cm-variable">r</span> = <span class="cm-builtin">max</span>(<span class="cm-number">0</span>, <span class="cm-variable">r</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">35</div><pre>        <span class="cm-keyword">return</span> <span class="cm-variable">r</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">36</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">37</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">pixels</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">38</div><pre>        <span class="cm-variable">pixs</span> = [[<span class="cm-number">0</span>]<span class="cm-operator">*</span><span class="cm-variable-2">self</span>.<span class="cm-property">size</span> <span class="cm-keyword">for</span> <span class="cm-variable">_</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">size</span>)]</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">39</div><pre>        <span class="cm-variable">reg</span> = <span class="cm-variable-2">self</span>.<span class="cm-property">register</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">40</div><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">ir</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">41</div><pre>            <span class="cm-keyword">for</span> <span class="cm-variable">ic</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">42</div><pre>                <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytes</span>([<span class="cm-variable">reg</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">43</div><pre>                <span class="cm-variable">val</span> = <span class="cm-variable">ustruct</span>.<span class="cm-property">unpack</span>(<span class="cm-string">'&lt;h'</span>, <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">read</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-variable">reg</span>, <span class="cm-number">2</span>))[<span class="cm-number">0</span>]</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">44</div><pre>                <span class="cm-variable">tmp</span> = (<span class="cm-variable-2">self</span>.<span class="cm-property">getval</span>(<span class="cm-variable">val</span>) <span class="cm-operator">-</span> <span class="cm-variable-2">self</span>.<span class="cm-property">offset</span>) <span class="cm-operator">*</span> <span class="cm-variable-2">self</span>.<span class="cm-property">rate</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">45</div><pre>                <span class="cm-variable">pixs</span>[<span class="cm-variable">ir</span>][<span class="cm-variable">ic</span>] = <span class="cm-variable">tmp</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">46</div><pre>                <span class="cm-variable">reg</span> += <span class="cm-number">2</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">47</div><pre>        <span class="cm-keyword">return</span> <span class="cm-variable">pixs</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">48</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">49</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">hotspot_x</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">50</div><pre>        <span class="cm-builtin">max</span>, <span class="cm-variable">indmax</span> = <span class="cm-number">0</span>, <span class="cm-number">0</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">51</div><pre>        <span class="cm-variable">reg</span> = <span class="cm-variable-2">self</span>.<span class="cm-property">register</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">52</div><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">ic</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">53</div><pre>            <span class="cm-keyword">for</span> <span class="cm-variable">ir</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">54</div><pre>                <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytes</span>([<span class="cm-variable">reg</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">55</div><pre>                <span class="cm-variable">val</span> = <span class="cm-variable">ustruct</span>.<span class="cm-property">unpack</span>(<span class="cm-string">'&lt;h'</span>, <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">read</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-variable">reg</span>, <span class="cm-number">2</span>))[<span class="cm-number">0</span>]</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">56</div><pre>                <span class="cm-variable">tmp</span> = (<span class="cm-variable-2">self</span>.<span class="cm-property">getval</span>(<span class="cm-variable">val</span>) <span class="cm-operator">-</span> <span class="cm-variable-2">self</span>.<span class="cm-property">offset</span>) <span class="cm-operator">*</span> <span class="cm-variable-2">self</span>.<span class="cm-property">rate</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">57</div><pre>                <span class="cm-keyword">if</span> <span class="cm-variable">tmp</span> <span class="cm-operator">&gt;</span> <span class="cm-builtin">max</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">58</div><pre>                    <span class="cm-builtin">max</span>, <span class="cm-variable">indmax</span> = <span class="cm-variable">tmp</span>, <span class="cm-variable">ic</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">59</div><pre>                <span class="cm-keyword">if</span> <span class="cm-number">2</span> <span class="cm-operator">&lt;</span>= <span class="cm-variable">ir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">7</span> <span class="cm-keyword">and</span> <span class="cm-number">2</span> <span class="cm-operator">&lt;</span>= <span class="cm-variable">ic</span> <span class="cm-operator">&lt;</span> <span class="cm-number">7</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">60</div><pre>                    <span class="cm-variable">mb</span>.<span class="cm-property">display</span>.<span class="cm-property">set_pixel</span>(<span class="cm-number">6</span><span class="cm-operator">-</span><span class="cm-variable">ic</span>, <span class="cm-number">6</span><span class="cm-operator">-</span><span class="cm-variable">ir</span>, <span class="cm-variable-2">self</span>.<span class="cm-property">convpix</span>(<span class="cm-variable">tmp</span>, <span class="cm-number">15</span>, <span class="cm-number">40</span>))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">61</div><pre>                <span class="cm-variable">reg</span> += <span class="cm-number">2</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">62</div><pre>        <span class="cm-keyword">return</span> <span class="cm-variable">indmax</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">63</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">64</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">65</div><pre><span class="cm-variable">amg</span> = <span class="cm-variable">Amg8833</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">66</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">67</div><pre><span class="cm-keyword">def</span> <span class="cm-def">hotsearch</span>():</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">68</div><pre>    <span class="cm-variable">hs</span> = <span class="cm-variable">amg</span>.<span class="cm-property">hotspot_x</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">69</div><pre>    <span class="cm-comment"># mb.display.show(hs)</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">70</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">71</div><pre>    <span class="cm-keyword">if</span> <span class="cm-variable">hs</span> <span class="cm-operator">&lt;</span> <span class="cm-number">3</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">72</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin8</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">1</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">73</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin12</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">74</div><pre>    <span class="cm-keyword">elif</span> <span class="cm-variable">hs</span> <span class="cm-operator">&gt;</span> <span class="cm-number">4</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">75</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin8</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">76</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin12</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">1</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">77</div><pre>    <span class="cm-keyword">else</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">78</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin8</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">79</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin12</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">80</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">81</div><pre><span class="cm-keyword">while</span> <span class="cm-keyword">True</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">82</div><pre>    <span class="cm-variable">hotsearch</span>()</pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;">import microbit as mb
import ustruct

class Amg8833():
    def __init__(self, addr=0x69):
        """Initiaisation capteur
        addr : adresse i2c. 0x69 par defaut"""
        self.addr = addr
        self.register = 0x80
        self.size = 8
        self.offset = 0
        self.rate = 1

        # PCTL NORMAL
        mb.i2c.write(self.addr, b'0x00')
        mb.i2c.write(self.addr, b'0x00')
        # INITIAL RESET
        mb.i2c.write(self.addr, b'0x01')
        mb.i2c.write(self.addr, b'0x3F')
        # FPS 10
        mb.i2c.write(self.addr, b'0x02')
        mb.i2c.write(self.addr, b'0x00')

    def getval(self, val):
        absval = (val &amp; 0x7FF)
        if val &amp; 0x800:
            return - float(0x800 - absval) * 0.25
        else:
            return float(absval) * 0.25

    def convpix(self, val, m1, m2):
        r = int((val-m1)/(m2-m1)*9)
        r = min(9, r)
        r = max(0, r)
        return r

    def pixels(self):
        pixs = [[0]*self.size for _ in range(self.size)]
        reg = self.register
        for ir in range(0, self.size):
            for ic in range(0, self.size):
                mb.i2c.write(self.addr, bytes([reg]))
                val = ustruct.unpack('&lt;h', mb.i2c.read(self.addr, reg, 2))[0]
                tmp = (self.getval(val) - self.offset) * self.rate
                pixs[ir][ic] = tmp
                reg += 2
        return pixs

    def hotspot_x(self):
        max, indmax = 0, 0
        reg = self.register
        for ic in range(self.size):
            for ir in range(self.size):
                mb.i2c.write(self.addr, bytes([reg]))
                val = ustruct.unpack('&lt;h', mb.i2c.read(self.addr, reg, 2))[0]
                tmp = (self.getval(val) - self.offset) * self.rate
                if tmp &gt; max:
                    max, indmax = tmp, ic
                if 2 &lt;= ir &lt; 7 and 2 &lt;= ic &lt; 7:
                    mb.display.set_pixel(6-ic, 6-ir, self.convpix(tmp, 15, 40))
                reg += 2
        return indmax


amg = Amg8833()

def hotsearch():
    hs = amg.hotspot_x()
    # mb.display.show(hs)

    if hs &lt; 3:
        mb.pin8.write_digital(1)
        mb.pin12.write_digital(0)
    elif hs &gt; 4:
        mb.pin8.write_digital(0)
        mb.pin12.write_digital(1)
    else:
        mb.pin8.write_digital(0)
        mb.pin12.write_digital(0)

while True:
    hotsearch()</pre></div></div></div></div></div></div></section><section class="hBk expUcDiv"><h3 class="hBk_ti"><span>Mise en route de rob_hot</span></h3><div class="hBk_co "><div class="iBk info"><div class="iBk_co "><div class="rBk "><p>Dans cette partie, nous allons simplement mettre en commun la partie sur le robot maqueen, en particulier le code sur la <a class="txt_ul ucLnk subLnk" target="_blank" role="button" href="g_maqueenObstacles_1.html" onclick="scDynUiMgr.displaySubWindow(this,&quot;g_maqueenObstacles_1.html&quot;,&quot;subWindow&quot;,{CLOSEBTNTI :'Fermer'});return false;" onkeyup="scDynUiMgr.handleBtnKeyUp(event);" onkeydown="scDynUiMgr.handleBtnKeyDwn(event);" id="i5" title="Robot Maqueen eviteur d'obstacles - Niveau d&eacute;butant (nouvelle fen&ecirc;tre)"><span>détection d'obstacles</span></a>, et la détection d'une source de chaleur.</p></div></div></div><div class="warning pBk"><h4 class="warning_ti pBk_ti"><span><i class="type"><span>Attention</span></i><span class="hidden"> : </span><span class="title">Mémoire limitée</span></span></h4><div class="warning_co pBk_co"><div class="rBk "><p>La RAM de la microbit est très limitée et on atteint ici les limites de ce que la carte peut accepter en python. Pour des projets plus conséquents, on sera obligé de revenir au langage C en utilisant par exemple l'environnement arduino.</p></div></div></div><div class="method pBk"><h4 class="method_ti pBk_ti"><span><i class="type"><span>Méthode</span></i><span class="hidden"> : </span><span class="title">Le programme rob_hot</span></span></h4><div class="method_co pBk_co"><div class="rBk "><p>Pour faire fonctionner le robot, j'ai élagué au maximum les classes maqueen et amg8833 en ne gardant que le strict minimum. Voici le robot en situation. Observez la manière dont il me suit, puisque je suis la source la plus chaude en face du capteur.</p></div><div class="rBk res"><figure role="group" class="resInFlow remoteVideo"><div class="resInFlow_co "><div class="mediaPlayer" id="nlGTeVIBpZP9YYyw508Bc" data-src="https://youtu.be/1C8hxsCQizw" data-max-width="630" data-max-height="630" data-alt-otherencoding="no" data-alt-istranscript="no" data-alt-transcriptinfosdoc="no" data-alt-transcript="text" data-alt-audiodesc="no" data-alt-audiodesctype="no" data-alt-altvideo="no" data-subtitles="no">
<video controls class="remoteVideo " style="max-width:630px;max-height:630px;"><source src="../../../external.html?link=https://youtu.be/1C8hxsCQizw"></source><em>Votre navigateur ne prend pas en charge cette ressource, vous pouvez la télécharger ici : <a target="_blank" href="../../../external.html?link=https://youtu.be/1C8hxsCQizw"><span>1C8hxsCQizw</span></a></em></video></div></div></figure></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-python"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre><span class="cm-keyword">import</span> <span class="cm-variable">microbit</span> <span class="cm-keyword">as</span> <span class="cm-variable">mb</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre><span class="cm-keyword">import</span> <span class="cm-variable">ustruct</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre><span class="cm-keyword">import</span> <span class="cm-variable">machine</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre><span class="cm-keyword">from</span> <span class="cm-variable">random</span> <span class="cm-keyword">import</span> <span class="cm-variable">randint</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre><span class="cm-keyword">class</span> <span class="cm-def">Maqueen</span>():</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">addr</span>=<span class="cm-number">0x10</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">8</div><pre>        <span class="cm-string">"""Initiaisation robot</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">9</div><pre><span class="cm-string">        addr : adresse i2c. 0x10 par defaut"""</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">10</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">addr</span> = <span class="cm-variable">addr</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">11</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span> = <span class="cm-number">0</span>  <span class="cm-comment"># vitesse entre 0 et 100</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">12</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">13</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">getVitesse</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">14</div><pre>        <span class="cm-keyword">return</span> <span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">15</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">16</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">setVitesse</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">v</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">17</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span> = <span class="cm-variable">v</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">18</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">19</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">moteurDroit</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">v</span>=<span class="cm-keyword">None</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">20</div><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">v</span> <span class="cm-keyword">is</span> <span class="cm-keyword">None</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">21</div><pre>            <span class="cm-variable">v</span> = <span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">22</div><pre>        <span class="cm-variable">sens</span> = <span class="cm-number">0</span> <span class="cm-keyword">if</span> <span class="cm-variable">v</span> <span class="cm-operator">&gt;</span>= <span class="cm-number">0</span> <span class="cm-keyword">else</span> <span class="cm-number">1</span>  <span class="cm-comment"># sens moteur</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">23</div><pre>        <span class="cm-variable">vit</span> = <span class="cm-builtin">abs</span>(<span class="cm-variable">v</span>)<span class="cm-operator">*</span><span class="cm-number">255</span><span class="cm-operator">//</span><span class="cm-number">100</span>   <span class="cm-comment"># vitesse moteur 0..255</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">24</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytearray</span>([<span class="cm-number">2</span>, <span class="cm-variable">sens</span>, <span class="cm-variable">vit</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">25</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">26</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">moteurGauche</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">v</span>=<span class="cm-keyword">None</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">27</div><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">v</span> <span class="cm-keyword">is</span> <span class="cm-keyword">None</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">28</div><pre>            <span class="cm-variable">v</span> = <span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">29</div><pre>        <span class="cm-variable">sens</span> = <span class="cm-number">0</span> <span class="cm-keyword">if</span> <span class="cm-variable">v</span> <span class="cm-operator">&gt;</span>= <span class="cm-number">0</span> <span class="cm-keyword">else</span> <span class="cm-number">1</span>  <span class="cm-comment"># sens moteur</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">30</div><pre>        <span class="cm-variable">vit</span> = <span class="cm-builtin">abs</span>(<span class="cm-variable">v</span>)<span class="cm-operator">*</span><span class="cm-number">255</span><span class="cm-operator">//</span><span class="cm-number">100</span>   <span class="cm-comment"># vitesse moteur 0..255</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">31</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytearray</span>([<span class="cm-number">0</span>, <span class="cm-variable">sens</span>, <span class="cm-variable">vit</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">32</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">33</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">avance</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">v</span>=<span class="cm-keyword">None</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">34</div><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">v</span> <span class="cm-keyword">is</span> <span class="cm-keyword">not</span> <span class="cm-keyword">None</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">35</div><pre>            <span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span> = <span class="cm-variable">v</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">36</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">moteurDroit</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">37</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">moteurGauche</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">38</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">39</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">recule</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">40</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">moteurDroit</span>(<span class="cm-operator">-</span><span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">41</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">moteurGauche</span>(<span class="cm-operator">-</span><span class="cm-variable-2">self</span>.<span class="cm-property">_vitesse</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">42</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">43</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">stop</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">44</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytearray</span>([<span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">45</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-number">1</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">46</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytearray</span>([<span class="cm-number">2</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">47</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">48</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">distance</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">49</div><pre>        <span class="cm-string">"""Calcule la distance à l'obstacle en cm</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">50</div><pre><span class="cm-string">        pin1 : Trig</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">51</div><pre><span class="cm-string">        pin2 : Echo"""</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">52</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin1</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">1</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">53</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-number">10</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">54</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin1</span>.<span class="cm-property">write_digital</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">55</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">56</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">pin2</span>.<span class="cm-property">read_digital</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">57</div><pre>        <span class="cm-variable">t2</span> = <span class="cm-variable">machine</span>.<span class="cm-property">time_pulse_us</span>(<span class="cm-variable">mb</span>.<span class="cm-property">pin2</span>, <span class="cm-number">1</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">58</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">59</div><pre>        <span class="cm-variable">d</span> = <span class="cm-number">340</span> <span class="cm-operator">*</span> <span class="cm-variable">t2</span> <span class="cm-operator">/</span> <span class="cm-number">20000</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">60</div><pre>        <span class="cm-keyword">return</span> <span class="cm-variable">d</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">61</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">62</div><pre><span class="cm-keyword">class</span> <span class="cm-def">Amg8833</span>():</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">63</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">__init__</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">addr</span>=<span class="cm-number">0x69</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">64</div><pre>        <span class="cm-string">"""Initiaisation capteur</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">65</div><pre><span class="cm-string">        addr : adresse i2c. 0x69 par defaut"""</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">66</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">addr</span> = <span class="cm-variable">addr</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">67</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">register</span> = <span class="cm-number">0x80</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">68</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">size</span> = <span class="cm-number">8</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">69</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">offset</span> = <span class="cm-number">0</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">70</div><pre>        <span class="cm-variable-2">self</span>.<span class="cm-property">rate</span> = <span class="cm-number">1</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">71</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">72</div><pre>        <span class="cm-comment"># PCTL NORMAL</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">73</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">74</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">75</div><pre>        <span class="cm-comment"># INITIAL RESET</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">76</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x01'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">77</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x3F'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">78</div><pre>        <span class="cm-comment"># FPS 10</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">79</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x02'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">80</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-string">b'0x00'</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">81</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">82</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">getval</span>(<span class="cm-variable-2">self</span>, <span class="cm-variable">val</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">83</div><pre>        <span class="cm-variable">absval</span> = (<span class="cm-variable">val</span> <span class="cm-operator">&amp;</span> <span class="cm-number">0x7FF</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">84</div><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">val</span> <span class="cm-operator">&amp;</span> <span class="cm-number">0x800</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">85</div><pre>            <span class="cm-keyword">return</span> <span class="cm-operator">-</span> <span class="cm-builtin">float</span>(<span class="cm-number">0x800</span> <span class="cm-operator">-</span> <span class="cm-variable">absval</span>) <span class="cm-operator">*</span> <span class="cm-number">0.25</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">86</div><pre>        <span class="cm-keyword">else</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">87</div><pre>            <span class="cm-keyword">return</span> <span class="cm-builtin">float</span>(<span class="cm-variable">absval</span>) <span class="cm-operator">*</span> <span class="cm-number">0.25</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">88</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">89</div><pre>    <span class="cm-keyword">def</span> <span class="cm-def">hotspot_x</span>(<span class="cm-variable-2">self</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">90</div><pre>        <span class="cm-keyword">def</span> <span class="cm-def">convpix</span>(<span class="cm-variable">val</span>, <span class="cm-variable">m1</span>, <span class="cm-variable">m2</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">91</div><pre>            <span class="cm-variable">r</span> = <span class="cm-builtin">int</span>((<span class="cm-variable">val</span><span class="cm-operator">-</span><span class="cm-variable">m1</span>)<span class="cm-operator">/</span>(<span class="cm-variable">m2</span><span class="cm-operator">-</span><span class="cm-variable">m1</span>)<span class="cm-operator">*</span><span class="cm-number">9</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">92</div><pre>            <span class="cm-variable">r</span> = <span class="cm-builtin">min</span>(<span class="cm-number">9</span>, <span class="cm-variable">r</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">93</div><pre>            <span class="cm-variable">r</span> = <span class="cm-builtin">max</span>(<span class="cm-number">0</span>, <span class="cm-variable">r</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">94</div><pre>            <span class="cm-keyword">return</span> <span class="cm-variable">r</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">95</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">96</div><pre>        <span class="cm-variable">mx</span>, <span class="cm-variable">indmax</span> = <span class="cm-number">0</span>, <span class="cm-number">0</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">97</div><pre>        <span class="cm-variable">reg</span> = <span class="cm-variable-2">self</span>.<span class="cm-property">register</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">98</div><pre>        <span class="cm-keyword">for</span> <span class="cm-variable">ic</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">99</div><pre>            <span class="cm-keyword">for</span> <span class="cm-variable">ir</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">size</span>):</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">100</div><pre>                <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">write</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-builtin">bytes</span>([<span class="cm-variable">reg</span>]))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">101</div><pre>                <span class="cm-variable">val</span> = <span class="cm-variable">ustruct</span>.<span class="cm-property">unpack</span>(<span class="cm-string">'&lt;h'</span>, <span class="cm-variable">mb</span>.<span class="cm-property">i2c</span>.<span class="cm-property">read</span>(<span class="cm-variable-2">self</span>.<span class="cm-property">addr</span>, <span class="cm-variable">reg</span>, <span class="cm-number">2</span>))[<span class="cm-number">0</span>]</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">102</div><pre>                <span class="cm-variable">tmp</span> = (<span class="cm-variable-2">self</span>.<span class="cm-property">getval</span>(<span class="cm-variable">val</span>) <span class="cm-operator">-</span> <span class="cm-variable-2">self</span>.<span class="cm-property">offset</span>) <span class="cm-operator">*</span> <span class="cm-variable-2">self</span>.<span class="cm-property">rate</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">103</div><pre>                <span class="cm-keyword">if</span> <span class="cm-variable">tmp</span> <span class="cm-operator">&gt;</span> <span class="cm-variable">mx</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">104</div><pre>                    <span class="cm-variable">mx</span>, <span class="cm-variable">indmax</span> = <span class="cm-variable">tmp</span>, <span class="cm-variable">ic</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">105</div><pre>                <span class="cm-keyword">if</span> <span class="cm-number">2</span> <span class="cm-operator">&lt;</span>= <span class="cm-variable">ir</span> <span class="cm-operator">&lt;</span> <span class="cm-number">7</span> <span class="cm-keyword">and</span> <span class="cm-number">2</span> <span class="cm-operator">&lt;</span>= <span class="cm-variable">ic</span> <span class="cm-operator">&lt;</span> <span class="cm-number">7</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">106</div><pre>                    <span class="cm-variable">mb</span>.<span class="cm-property">display</span>.<span class="cm-property">set_pixel</span>(<span class="cm-number">6</span><span class="cm-operator">-</span><span class="cm-variable">ic</span>, <span class="cm-number">6</span><span class="cm-operator">-</span><span class="cm-variable">ir</span>, <span class="cm-variable">convpix</span>(<span class="cm-variable">tmp</span>, <span class="cm-number">15</span>, <span class="cm-number">40</span>))</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">107</div><pre>                <span class="cm-variable">reg</span> += <span class="cm-number">2</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">108</div><pre>        <span class="cm-keyword">return</span> <span class="cm-variable">indmax</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">109</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">110</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">111</div><pre><span class="cm-variable">mq</span> = <span class="cm-variable">Maqueen</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">112</div><pre><span class="cm-variable">amg</span> = <span class="cm-variable">Amg8833</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">113</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">114</div><pre><span class="cm-keyword">def</span> <span class="cm-def">obstacle</span>():</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">115</div><pre>    <span class="cm-variable">d</span> = <span class="cm-variable">mq</span>.<span class="cm-property">distance</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">116</div><pre>    <span class="cm-keyword">if</span> <span class="cm-variable">d</span> <span class="cm-operator">&lt;</span> <span class="cm-number">20</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">117</div><pre>        <span class="cm-variable">r</span> = <span class="cm-variable">randint</span>(<span class="cm-number">1</span>, <span class="cm-number">3</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">118</div><pre>        <span class="cm-keyword">if</span> <span class="cm-variable">r</span> == <span class="cm-number">1</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">119</div><pre>            <span class="cm-variable">mq</span>.<span class="cm-property">recule</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">120</div><pre>            <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-number">2000</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">121</div><pre>            <span class="cm-variable">mq</span>.<span class="cm-property">moteurGauche</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">122</div><pre>            <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-number">1000</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">123</div><pre>        <span class="cm-keyword">elif</span> <span class="cm-variable">r</span> == <span class="cm-number">2</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">124</div><pre>            <span class="cm-variable">mq</span>.<span class="cm-property">moteurDroit</span>(<span class="cm-number">50</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">125</div><pre>            <span class="cm-variable">mq</span>.<span class="cm-property">moteurGauche</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">126</div><pre>            <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-number">1000</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">127</div><pre>        <span class="cm-keyword">elif</span> <span class="cm-variable">r</span> == <span class="cm-number">3</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">128</div><pre>            <span class="cm-variable">mq</span>.<span class="cm-property">moteurDroit</span>(<span class="cm-operator">-</span><span class="cm-number">50</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">129</div><pre>            <span class="cm-variable">mq</span>.<span class="cm-property">moteurGauche</span>(<span class="cm-number">50</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">130</div><pre>            <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-number">1000</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">131</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">132</div><pre><span class="cm-keyword">def</span> <span class="cm-def">hotsearch</span>():</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">133</div><pre>    <span class="cm-variable">pause</span> = <span class="cm-number">200</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">134</div><pre>    <span class="cm-variable">hs</span> = <span class="cm-variable">amg</span>.<span class="cm-property">hotspot_x</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">135</div><pre>    <span class="cm-comment"># mb.display.show(hs)</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">136</div><pre>    <span class="cm-variable">m2</span> = <span class="cm-variable">mq</span>.<span class="cm-property">moteurDroit</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">137</div><pre>    <span class="cm-variable">m1</span> = <span class="cm-variable">mq</span>.<span class="cm-property">moteurGauche</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">138</div><pre>    <span class="cm-keyword">if</span> <span class="cm-variable">hs</span> <span class="cm-operator">&lt;</span> <span class="cm-number">1</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">139</div><pre>        <span class="cm-variable">m2</span>(<span class="cm-number">100</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">140</div><pre>        <span class="cm-variable">m1</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">141</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-variable">pause</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">142</div><pre>    <span class="cm-keyword">elif</span> <span class="cm-variable">hs</span> <span class="cm-operator">&lt;</span> <span class="cm-number">2</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">143</div><pre>        <span class="cm-variable">m2</span>(<span class="cm-number">50</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">144</div><pre>        <span class="cm-variable">m1</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">145</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-variable">pause</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">146</div><pre>    <span class="cm-keyword">elif</span> <span class="cm-variable">hs</span> <span class="cm-operator">&lt;</span> <span class="cm-number">3</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">147</div><pre>        <span class="cm-variable">m2</span>(<span class="cm-number">25</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">148</div><pre>        <span class="cm-variable">m1</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">149</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-variable">pause</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">150</div><pre>    <span class="cm-keyword">elif</span> <span class="cm-variable">hs</span> <span class="cm-operator">&gt;</span> <span class="cm-number">6</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">151</div><pre>        <span class="cm-variable">m2</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">152</div><pre>        <span class="cm-variable">m1</span>(<span class="cm-number">100</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">153</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-variable">pause</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">154</div><pre>    <span class="cm-keyword">elif</span> <span class="cm-variable">hs</span> <span class="cm-operator">&gt;</span> <span class="cm-number">5</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">155</div><pre>        <span class="cm-variable">m2</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">156</div><pre>        <span class="cm-variable">m1</span>(<span class="cm-number">50</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">157</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-variable">pause</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">158</div><pre>    <span class="cm-keyword">elif</span> <span class="cm-variable">hs</span> <span class="cm-operator">&gt;</span> <span class="cm-number">4</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">159</div><pre>        <span class="cm-variable">m2</span>(<span class="cm-number">0</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">160</div><pre>        <span class="cm-variable">m1</span>(<span class="cm-number">25</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">161</div><pre>        <span class="cm-variable">mb</span>.<span class="cm-property">sleep</span>(<span class="cm-variable">pause</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">162</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">163</div><pre><span class="cm-variable">mq</span>.<span class="cm-property">setVitesse</span>(<span class="cm-number">25</span>)</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">164</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">165</div><pre><span class="cm-keyword">while</span> <span class="cm-keyword">True</span>:</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">166</div><pre>    <span class="cm-variable">hotsearch</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">167</div><pre>    <span class="cm-variable">obstacle</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">168</div><pre>    <span class="cm-variable">mq</span>.<span class="cm-property">avance</span>()</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">169</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">170</div><pre></pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;">import microbit as mb
import ustruct
import machine
from random import randint

class Maqueen():
    def __init__(self, addr=0x10):
        """Initiaisation robot
        addr : adresse i2c. 0x10 par defaut"""
        self.addr = addr
        self._vitesse = 0  # vitesse entre 0 et 100

    def getVitesse(self):
        return self._vitesse

    def setVitesse(self, v):
        self._vitesse = v

    def moteurDroit(self, v=None):
        if v is None:
            v = self._vitesse
        sens = 0 if v &gt;= 0 else 1  # sens moteur
        vit = abs(v)*255//100   # vitesse moteur 0..255
        mb.i2c.write(self.addr, bytearray([2, sens, vit]))

    def moteurGauche(self, v=None):
        if v is None:
            v = self._vitesse
        sens = 0 if v &gt;= 0 else 1  # sens moteur
        vit = abs(v)*255//100   # vitesse moteur 0..255
        mb.i2c.write(self.addr, bytearray([0, sens, vit]))

    def avance(self, v=None):
        if v is not None:
            self._vitesse = v
        self.moteurDroit()
        self.moteurGauche()

    def recule(self):
        self.moteurDroit(-self._vitesse)
        self.moteurGauche(-self._vitesse)

    def stop(self):
        mb.i2c.write(self.addr, bytearray([0, 0, 0]))
        mb.sleep(1)
        mb.i2c.write(self.addr, bytearray([2, 0, 0]))

    def distance(self):
        """Calcule la distance à l'obstacle en cm
        pin1 : Trig
        pin2 : Echo"""
        mb.pin1.write_digital(1)
        mb.sleep(10)
        mb.pin1.write_digital(0)

        mb.pin2.read_digital()
        t2 = machine.time_pulse_us(mb.pin2, 1)

        d = 340 * t2 / 20000
        return d

class Amg8833():
    def __init__(self, addr=0x69):
        """Initiaisation capteur
        addr : adresse i2c. 0x69 par defaut"""
        self.addr = addr
        self.register = 0x80
        self.size = 8
        self.offset = 0
        self.rate = 1

        # PCTL NORMAL
        mb.i2c.write(self.addr, b'0x00')
        mb.i2c.write(self.addr, b'0x00')
        # INITIAL RESET
        mb.i2c.write(self.addr, b'0x01')
        mb.i2c.write(self.addr, b'0x3F')
        # FPS 10
        mb.i2c.write(self.addr, b'0x02')
        mb.i2c.write(self.addr, b'0x00')

    def getval(self, val):
        absval = (val &amp; 0x7FF)
        if val &amp; 0x800:
            return - float(0x800 - absval) * 0.25
        else:
            return float(absval) * 0.25

    def hotspot_x(self):
        def convpix(val, m1, m2):
            r = int((val-m1)/(m2-m1)*9)
            r = min(9, r)
            r = max(0, r)
            return r

        mx, indmax = 0, 0
        reg = self.register
        for ic in range(self.size):
            for ir in range(self.size):
                mb.i2c.write(self.addr, bytes([reg]))
                val = ustruct.unpack('&lt;h', mb.i2c.read(self.addr, reg, 2))[0]
                tmp = (self.getval(val) - self.offset) * self.rate
                if tmp &gt; mx:
                    mx, indmax = tmp, ic
                if 2 &lt;= ir &lt; 7 and 2 &lt;= ic &lt; 7:
                    mb.display.set_pixel(6-ic, 6-ir, convpix(tmp, 15, 40))
                reg += 2
        return indmax


mq = Maqueen()
amg = Amg8833()

def obstacle():
    d = mq.distance()
    if d &lt; 20:
        r = randint(1, 3)
        if r == 1:
            mq.recule()
            mb.sleep(2000)
            mq.moteurGauche(0)
            mb.sleep(1000)
        elif r == 2:
            mq.moteurDroit(50)
            mq.moteurGauche(0)
            mb.sleep(1000)
        elif r == 3:
            mq.moteurDroit(-50)
            mq.moteurGauche(50)
            mb.sleep(1000)

def hotsearch():
    pause = 200
    hs = amg.hotspot_x()
    # mb.display.show(hs)
    m2 = mq.moteurDroit
    m1 = mq.moteurGauche
    if hs &lt; 1:
        m2(100)
        m1(0)
        mb.sleep(pause)
    elif hs &lt; 2:
        m2(50)
        m1(0)
        mb.sleep(pause)
    elif hs &lt; 3:
        m2(25)
        m1(0)
        mb.sleep(pause)
    elif hs &gt; 6:
        m2(0)
        m1(100)
        mb.sleep(pause)
    elif hs &gt; 5:
        m2(0)
        m1(50)
        mb.sleep(pause)
    elif hs &gt; 4:
        m2(0)
        m1(25)
        mb.sleep(pause)

mq.setVitesse(25)

while True:
    hotsearch()
    obstacle()
    mq.avance()

</pre></div></div></div></div></div></div></section></div></section></div></div><div id="navigation" tabindex="-1"><hr class="hidden"><nav class="pageTurner" role="navigation"><ul><li><a rel="prev" href="g_maqueenObstacles.html" target="_self" class="btnNav prev" title="Pr&eacute;c&eacute;dent (Robot Maqueen eviteur d'obstacles - Niveau d&eacute;butant)"><span>Précédent</span></a></li><li><a rel="next" href="g_maqueenRemote.html" target="_self" class="btnNav next" title="Suivant (Robot Maqueen t&eacute;l&eacute;command&eacute; - Niveau interm&eacute;diaire)"><span>Suivant</span></a></li></ul></nav></div></div><div id="toolbox"><nav id="menu" class="pageSelector" role="navigation" tabindex="-1" aria-label="menu principal"><hr class="hidden"><ul class="mnu static" data-totalPages="80"><li class="sel_no anc_no type_l  dpt_0 intro"><div class="lbl type_l" id="module_Micropython_1.html"><a href="module_Micropython_1.html" target="_self" class="item"><span>Introduction</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="AA_circuitPython.html"><a href="AA_circuitPython.html" target="_self" class="item"><span>Adafruit ? CircuitPython ?</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="AA_edublocks.html"><a href="AA_edublocks.html" target="_self" class="item"><span>Découverte de CircuitPython avec edublocks</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="AA_circuitPython_1.html"><a href="AA_circuitPython_1.html" target="_self" class="item"><span>de l'Arduino vers CircuitPython</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="AA_mu.html"><a href="AA_mu.html" target="_self" class="item"><span>projets CPX</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="AA_autresProjets.html"><a href="AA_autresProjets.html" target="_self" class="item"><span>Projets divers autour de CircuitPython</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="AA_displayio.html"><a href="AA_displayio.html" target="_self" class="item"><span>Graphisme sous CircuitPython - utilisation de displayio</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="aa_gameConsole.html"><a href="aa_gameConsole.html" target="_self" class="item"><span>Fabriquer sa console de jeu - Niveau avancé</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 ueDiv"><div class="lbl type_b" id="module_Micropython_2.html"><a href="module_Micropython_2.html" target="_self" class="item"><span>Objets connectés (IoT) - MicroPython sur ESP8266 et ESP32</span></a></div></li><li class="sel_no anc_yes type_b  dpt_0 ueDiv"><div class="lbl type_b" id="module_Micropython_3.html"><a href="module_Micropython_3.html" target="_self" class="item" type="up"><span>Micropython sur la carte BBC micro::bit</span></a></div><ul class="sub mnu_open"><li class="sel_no anc_no type_l  dpt_1 intro"><div class="lbl type_l" id="module_Micropython_5.html"><a href="module_Micropython_5.html" target="_self" class="item"><span>Introduction</span></a></div></li><li class="sel_no anc_no type_l  dpt_1 expUc"><div class="lbl type_l" id="G_mu_1.html"><a href="G_mu_1.html" target="_self" class="item"><span>Utiliser l'éditeur Mu</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_1 courseUa"><div class="lbl type_b" id="AA_kitSurvie.html"><a href="AA_kitSurvie.html" target="_self" class="item"><span>kit de survie de la carte microbit sous MicroPython</span></a></div></li><li class="sel_no anc_no type_l  dpt_1 expUc"><div class="lbl type_l" id="g_exosMB.html"><a href="g_exosMB.html" target="_self" class="item"><span>Activités de prise en main de la micro:bit</span></a></div></li><li class="sel_no anc_yes type_b  dpt_1 courseUa"><div class="lbl type_b" id="AA_projets.html"><a href="AA_projets.html" target="_self" class="item" type="up"><span>Mini-projets sur Microbit</span></a></div><ul class="sub mnu_open"><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_compteur.html"><a href="g_compteur.html" target="_self" class="item"><span>Réaliser un compteur - niveau facile</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_shifumi.html"><a href="g_shifumi.html" target="_self" class="item"><span>Jeu de Pierre Feuille Ciseaux</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_maqueenObstacles.html"><a href="g_maqueenObstacles.html" target="_self" class="item"><span>Robot Maqueen eviteur d'obstacles - Niveau débutant</span></a></div></li><li class="sel_yes anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_robhot.html"><span class="item"><span>rob_hot : le robot guidé à la chaleur - niveau intermédiaire</span></span></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_maqueenRemote.html"><a href="g_maqueenRemote.html" target="_self" class="item"><span>Robot Maqueen télécommandé - Niveau intermédiaire</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_canicule.html"><a href="g_canicule.html" target="_self" class="item"><span>Alerte canicule ! - niveau facile</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_feuChantier.html"><a href="g_feuChantier.html" target="_self" class="item"><span>Simulation d'un feu de chantier pour la circulation automobile</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_vitesseSon.html"><a href="g_vitesseSon.html" target="_self" class="item"><span>Mesurer la vitesse du son</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_GPS.html"><a href="g_GPS.html" target="_self" class="item"><span>Lire un GPS avec la carte micro:bit - Niveau intermédiaire</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_batnav.html"><a href="g_batnav.html" target="_self" class="item"><span>le jeu de bataille navale - Niveau intermédiaire</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_scudFighter.html"><a href="g_scudFighter.html" target="_self" class="item"><span>Jeu de tir : scudFighter - Niveau intermédiaire</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_roueCodeuse.html"><a href="g_roueCodeuse.html" target="_self" class="item"><span>La roue codeuse - Niveau intermédiaire</span></a></div></li><li class="sel_no anc_no type_l  dpt_2 expUc"><div class="lbl type_l" id="g_stroboscope.html"><a href="g_stroboscope.html" target="_self" class="item"><span>Effet stroboscopique - Niveau intermédiaire</span></a></div></li></ul></li></ul></li></ul></nav><div id="tools" tabindex="-1"><hr class="hidden"><nav class="headingSelector" role="navigation"><ul class="mnu"><li class="anc_no home" data-position="uncle"><div class="lbl"><a href="module_Micropython.html" target="_self" class="item" type="index" title="Page d'accueil du module"><span>Accueil</span></a></div></li><li class="anc_yes module" data-position="ancestor"><div class="lbl"><span class="item"><span>Module</span></span></div></li></ul></nav></div></div></main><footer id="footer" role="contentinfo" tabindex="-1"><hr class="hidden"><a id="linkSp" target="_blank" href="../../../external.html?link=https://www.scenari.org/" title="R&eacute;alis&eacute; avec Scenari (nouvelle fen&ecirc;tre)"><span><img alt="R&eacute;alis&eacute; avec Scenari (nouvelle fen&ecirc;tre)" src="../skin/img/tpl/scBtn.png"></span></a></footer></div>
  <script type="text/JavaScript" src="../skin/js/skin.js"></script>
  <script type="text/javascript">tplMgr.init();scCodeMgr.init();scMediaMgr.init("ide:content/chi:div/chi:section/des:.mediaPlayer",{processYoutubeUrls :true});scImgMgr.init();outMgr.init();</script>
 </body>

<!-- Mirrored from lecluseo.scenari-community.org/CircuitPython/co/g_robhot.html by HTTraQt Website Copier/1.x [Karbofos 2012-2017] mer., 24 août 2022 06:41:12 GMT -->
</html>
